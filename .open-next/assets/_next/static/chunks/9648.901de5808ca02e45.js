"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9648],{60080:(e,t,a)=>{a.d(t,{z:()=>i});var s=a(26614);let r=(e,t)=>{try{if("undefined"==typeof navigator||!0!==navigator.onLine)return;s.Ay.capture(e,null!=t?t:{})}catch(e){}},i={pageView:(e,t)=>{try{let a=window.location.href;r("$pageview",{$current_url:a,page:e,...t})}catch(e){}},workoutStarted:(e,t)=>{r("workout_started",{templateId:e,templateName:t,timestamp:new Date().toISOString()})},workoutCompleted:(e,t,a)=>{r("workout_completed",{sessionId:e,duration:t,exerciseCount:a,timestamp:new Date().toISOString()})},exerciseLogged:(e,t,a,s)=>{r("exercise_logged",{exerciseId:e,exerciseName:t,sets:a,weight:s,timestamp:new Date().toISOString()})},templateCreated:(e,t)=>{r("template_created",{templateId:e,exerciseCount:t,timestamp:new Date().toISOString()})},templateDeleted:e=>{r("template_deleted",{templateId:e,timestamp:new Date().toISOString()})},templateEdited:(e,t)=>{r("template_edited",{templateId:e,exerciseCount:t,timestamp:new Date().toISOString()})},templateDuplicated:e=>{r("template_duplicated",{templateId:e,timestamp:new Date().toISOString()})},weightUnitChanged:e=>{r("weight_unit_changed",{unit:e,timestamp:new Date().toISOString()})},error:(e,t)=>{r("error",{error:e.message,stack:e.stack,context:t,timestamp:new Date().toISOString()})},featureUsed:(e,t)=>{r("feature_used",{feature:e,...t,timestamp:new Date().toISOString()})},aiDebriefViewed:(e,t,a)=>{r("ai_debrief.viewed",{sessionId:e,version:t,streakLength:a,timestamp:new Date().toISOString()})},aiDebriefRegenerated:(e,t,a)=>{r("ai_debrief.regenerated",{sessionId:e,version:t,reason:a,timestamp:new Date().toISOString()})},aiDebriefDismissed:(e,t,a)=>{r("ai_debrief.dismissed",{sessionId:e,version:t,pinned:a,timestamp:new Date().toISOString()})}}},99648:(e,t,a)=>{a.r(t),a.d(t,{RecentWorkouts:()=>F});var s=a(95155),r=a(12115),i=a(52619),n=a.n(i),l=a(20063),o=a(35528),c=a(71408),d=a(6191),u=a(52987),m=a(16485),x=a(26983),p=a(35299),h=a(80842),f=a(60080),g=a(64269);let v=e=>{if("number"==typeof e)return Number.isFinite(e)?e:0;if("string"==typeof e){let t=parseFloat(e);return Number.isFinite(t)?t:0}return 0},w=(e,t,a)=>Number.isFinite(e)?t===a?e:"lbs"===t&&"kg"===a?e/2.2046226218:"kg"===t&&"lbs"===a?2.2046226218*e:e:0,y=e=>{if(!e)return null;if(e instanceof Date)return new Date(e);let t=new Date(e);return Number.isNaN(t.getTime())?null:t},N=e=>{var t,a,s,r;let i=(e=>{var t;if(!(null==(t=e.exercises)?void 0:t.length))return"kg";let a=0,s=0;for(let t of e.exercises)(null==t?void 0:t.unit)==="lbs"?s+=1:(null==t?void 0:t.unit)==="kg"&&(a+=1);return s>a?"lbs":"kg"})(e),n=0,l=0;for(let o of null!=(t=e.exercises)?t:[]){let e=null!=(a=null==o?void 0:o.sets)?a:1,t=null!=(s=null==o?void 0:o.reps)?s:0,c=w(v(null!=(r=null==o?void 0:o.weight)?r:null==o?void 0:o.one_rm_estimate),null==o?void 0:o.unit,i),d=(null==o?void 0:o.volume_load)?w(v(o.volume_load),null==o?void 0:o.unit,i):null;Number.isFinite(e)&&Number.isFinite(t)&&e>0&&t>0?(Number.isFinite(c)&&c>0&&(l+=null!=d?d:c*t*e),n+=e):Number.isFinite(e)&&e>0&&(n+=e)}let o=(e=>{if("number"==typeof e.duration){let t=e.duration;return Number.isFinite(t)?t:null}if("number"==typeof e.durationMinutes){let t=e.durationMinutes;return Number.isFinite(t)?t:null}let t=e.perf_metrics;if(t&&"object"==typeof t){let e=t.durationMinutes;if("number"==typeof e&&Number.isFinite(e))return e}return null})(e),c=null!=o?o:n>0?3.5*n:null,d=(e=>{var t;if("number"==typeof e.exerciseCount)return Math.max(0,e.exerciseCount);if(!(null==(t=e.exercises)?void 0:t.length))return 0;let a=new Set;for(let t of e.exercises)(null==t?void 0:t.exerciseName)&&a.add(t.exerciseName);return a.size})(e),u=[];for(null!==o?u.push({label:"Duration",value:"".concat(Math.max(1,Math.round(o))," min")}):null!==c&&u.push({label:"Duration",value:"~".concat(Math.max(1,Math.round(c))," min")}),l>0?u.push({label:"Volume",value:((e,t)=>e<=0?"0 ".concat(t):e>=1e4?"".concat(Math.round(e/1e3),"k ").concat(t):e>=1e3?"".concat((e/1e3).toFixed(1),"k ").concat(t):"".concat(Math.round(e).toLocaleString()," ").concat(t))(l,i)}):n>0&&u.push({label:"Sets",value:n.toString()}),d>0&&u.push({label:"Exercises",value:d.toString()});u.length<3;)u.push({label:"—",value:"—"});return{exerciseCount:d,totalSets:n,totalVolume:l,volumeUnit:i,durationMinutes:o,estimatedDurationMinutes:c,metrics:u.slice(0,3)}},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,a=y(e);return!!a&&(new Date().getTime()-a.getTime())/36e5<=t},j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,a=y(e);if(!a)return"Unknown";let s=Math.floor((t.getTime()-a.getTime())/864e5);return 0===s?"Today":1===s?"Yesterday":s<7?"".concat(s," days ago"):a.toLocaleDateString("en-US",{month:"short",day:"numeric",year:a.getFullYear()!==t.getFullYear()?"numeric":void 0})};var k=a(86948),S=a(3998),D=a(11647),I=a(62998);let R={card:3,dashboard:5},_=(e,t)=>{let a=e.template;if(a&&"object"==typeof a&&!Array.isArray(a)&&"string"==typeof a.name){let e=a.name.trim();if(e.length>0)return e}return t},F=r.forwardRef((e,t)=>{let{className:a,limit:i,variant:n="card"}=e,o=(0,l.useRouter)(),c=h.F.useUtils(),d=null!=i?i:R[n],{data:u,isLoading:m,error:x}=h.F.workouts.getRecent.useQuery({limit:d}),p=h.F.workouts.start.useMutation(),[g,v]=r.useState(null),w=r.useCallback(async e=>{if(!(null==e?void 0:e.templateId))return void console.error("Cannot repeat workout without templateId",e);if(!p.isPending){v(e.id);try{let t=await p.mutateAsync({templateId:e.templateId,workoutDate:new Date});f.z.workoutStarted(e.templateId.toString(),_(e,"Repeated Workout")),f.z.featureUsed("repeat_workout",{templateId:e.templateId,workoutId:e.id}),c.workouts.getRecent.invalidate(),o.push("/workout/session/".concat(t.sessionId))}catch(e){console.error("Failed to repeat workout",e),alert("Couldn't start that workout. Please try again.")}finally{v(null)}}},[p,o,c]),y=r.useCallback(e=>{o.push("/workouts/".concat(e))},[o]),N=r.useCallback(()=>{o.push("/workout/start")},[o]);return"dashboard"===n?(0,s.jsx)(W,{className:a,error:x,forwardedRef:t,isLoading:m,limit:d,onRepeat:w,onStartNewWorkout:N,onViewDetails:y,repeatPending:p.isPending,repeatingWorkoutId:g,workouts:u}):(0,s.jsx)(M,{className:a,error:x,forwardedRef:t,isLoading:m,limit:d,onRepeat:w,repeatPending:p.isPending,repeatingWorkoutId:g,workouts:u})});F.displayName="RecentWorkouts";let W=e=>{let{className:t,error:a,forwardedRef:r,isLoading:i,limit:l,onStartNewWorkout:m,onRepeat:x,onViewDetails:p,repeatPending:h,repeatingWorkoutId:f,workouts:v}=e;return a?(0,s.jsxs)("div",{ref:r,className:(0,g.cn)("space-y-4",t),children:[(0,s.jsx)("h2",{className:"text-foreground mb-4 text-xl font-semibold",children:"Recent Workouts"}),(0,s.jsxs)("div",{className:"border-border text-muted-foreground rounded-lg border border-dashed p-6 text-center",children:[(0,s.jsx)("p",{children:"Unable to load recent workouts"}),(0,s.jsx)("p",{className:"mt-2 text-sm",children:"Please try again later."})]})]}):i?(0,s.jsxs)("div",{ref:r,className:(0,g.cn)("space-y-4 sm:space-y-6",t),children:[(0,s.jsx)(o.P.h2,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"font-display text-foreground mb-4 text-xl font-bold sm:mb-6 sm:text-2xl",children:"Recent Workouts"}),(0,s.jsx)("div",{className:"space-y-3 sm:space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(o.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05*t},className:"animate-pulse",children:(0,s.jsx)("div",{className:"glass-surface bg-muted h-[180px] rounded-xl sm:h-[200px]"})},t))})]}):(null==v?void 0:v.length)?(0,s.jsxs)("div",{ref:r,className:(0,g.cn)("space-y-4 sm:space-y-6",t),children:[(0,s.jsxs)(o.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"font-display text-foreground text-xl font-bold sm:text-2xl",children:"Recent Workouts"}),v.length>=l&&(0,s.jsx)(o.P.div,{whileHover:{x:2},whileTap:{scale:.95},children:(0,s.jsxs)(n(),{href:"/workouts",className:(0,g.cn)("inline-flex items-center gap-2 rounded-lg px-3 py-2","text-primary text-sm font-medium transition-all duration-200","hover:bg-primary/5 hover:text-primary/80","focus:ring-primary/20 focus:ring-2 focus:outline-none"),children:["View All",(0,s.jsx)(u.A,{className:"h-4 w-4"})]})})]}),(0,s.jsx)(c.N,{mode:"popLayout",children:(0,s.jsx)("div",{className:"space-y-3 sm:space-y-4",children:v.map((e,t)=>{var a,r;let i=N(e),n=(e=>{if(!e)return new Date().toISOString();if(e instanceof Date)return e.toISOString();let t=new Date(e);return Number.isNaN(t.getTime())?new Date().toISOString():t.toISOString()})(null!=(a=e.workoutDate)?a:e.createdAt),l=b(null!=(r=e.createdAt)?r:e.workoutDate),c=h&&f===e.id;return(0,s.jsx)(o.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2,delay:.05*t,ease:[.4,0,.2,1]},children:(0,s.jsx)(I.k,{workoutName:_(e,"Unnamed Workout"),date:n,metrics:i.metrics,isRecent:l,onRepeat:()=>{c||x(e)},onViewDetails:()=>p(e.id)})},e.id)})})})]}):(0,s.jsxs)("div",{ref:r,className:(0,g.cn)("space-y-4 sm:space-y-6",t),children:[(0,s.jsx)(o.P.h2,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"font-display text-foreground mb-4 text-xl font-bold sm:mb-6 sm:text-2xl",children:"Recent Workouts"}),(0,s.jsxs)(o.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},className:"glass-surface relative overflow-hidden rounded-xl p-8 text-center sm:p-12",children:[(0,s.jsx)("div",{className:"absolute inset-0 opacity-5",style:{background:"var(--gradient-universal-action-primary)"},"aria-hidden":"true"}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)(o.P.div,{className:"mb-6 text-5xl sm:text-6xl",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20,delay:.2},children:"\uD83D\uDCAA"}),(0,s.jsx)("h3",{className:"font-display text-foreground mb-2 text-lg font-bold sm:text-xl",children:"No workouts yet"}),(0,s.jsx)("p",{className:"text-muted-foreground mx-auto mb-6 max-w-sm text-sm",children:"Start your first workout to see it appear here and begin tracking your fitness journey."}),(0,s.jsxs)(o.P.button,{onClick:m,className:(0,g.cn)("inline-flex items-center gap-2 rounded-xl px-6 py-3 text-white","font-medium transition-all duration-200 hover:scale-105 active:scale-95","focus:ring-primary focus:ring-2 focus:ring-offset-2 focus:outline-none","shadow-lg hover:shadow-xl"),style:{background:"var(--gradient-universal-action-primary)"},whileHover:{y:-2},whileTap:{scale:.95},children:[(0,s.jsx)(d.A,{className:"h-5 w-5"}),"Start Your First Workout"]})]})]})]})},M=e=>{let{className:t,error:a,forwardedRef:r,isLoading:i,onRepeat:l,repeatPending:o,repeatingWorkoutId:c,workouts:d}=e;return i?(0,s.jsx)("div",{ref:r,className:(0,g.cn)(t),children:(0,s.jsxs)(k.Zp,{className:"border-0 shadow-lg",children:[(0,s.jsx)(k.aR,{className:"pb-4",children:(0,s.jsx)(k.ZB,{className:"font-serif text-2xl font-black",children:"Recent Workouts"})}),(0,s.jsx)(k.Wu,{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"bg-muted/30 rounded-xl p-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"skeleton skeleton-text h-6 w-32"}),(0,s.jsx)("div",{className:"skeleton skeleton-text h-4 w-48"}),(0,s.jsx)("div",{className:"skeleton skeleton-text h-4 w-56"})]})},t))})]})}):!a&&(null==d?void 0:d.length)?(0,s.jsx)("div",{ref:r,className:(0,g.cn)(t),children:(0,s.jsxs)(k.Zp,{className:"border-0 shadow-lg",children:[(0,s.jsx)(k.aR,{className:"pb-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(k.ZB,{className:"font-serif text-2xl font-black",children:"Recent Workouts"}),(0,s.jsx)(n(),{href:"/workouts",children:(0,s.jsx)(S.Button,{variant:"outline",size:"sm",children:"View All"})})]})}),(0,s.jsx)(k.Wu,{className:"space-y-4",children:d.map(e=>{var t;let a=N(e),r=j(null!=(t=e.workoutDate)?t:e.createdAt),i=((e,t)=>null!==e?"".concat(Math.max(1,Math.round(e))," min"):null!==t?"~".concat(Math.max(1,Math.round(t))," min"):"-- min")(a.durationMinutes,a.estimatedDurationMinutes),d=["".concat(a.exerciseCount," exercise").concat(1===a.exerciseCount?"":"s"),"".concat(a.totalSets," set").concat(1===a.totalSets?"":"s")],u=a.metrics.find(e=>"Volume"===e.label);u&&d.push(u.value);let h=o&&c===e.id;return(0,s.jsxs)("div",{className:"bg-muted/30 hover:bg-muted/50 flex items-center justify-between rounded-xl p-4 transition-colors",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h4",{className:"text-foreground font-semibold",children:_(e,"Workout")}),(0,s.jsx)(D.E,{variant:"secondary",className:"from-chart-1 to-chart-3 text-primary-foreground bg-gradient-to-r",children:"completed"})]}),(0,s.jsxs)("div",{className:"text-muted-foreground flex items-center gap-4 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.A,{className:"h-4 w-4"}),r]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(x.A,{className:"h-4 w-4"}),i]})]}),(0,s.jsx)("div",{className:"text-muted-foreground text-sm",children:d.join(" • ")})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n(),{href:"/workout/session/".concat(e.id),children:(0,s.jsx)(S.Button,{variant:"ghost",size:"sm",children:"View"})}),(0,s.jsx)(S.Button,{variant:"outline",size:"sm",onClick:()=>{h||l(e)},disabled:h,children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Repeating"]}):"Repeat"})]})]},e.id)})})]})}):(0,s.jsx)("div",{ref:r,className:(0,g.cn)(t),children:(0,s.jsxs)(k.Zp,{className:"border-0 shadow-lg",children:[(0,s.jsx)(k.aR,{className:"pb-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(k.ZB,{className:"font-serif text-2xl font-black",children:"Recent Workouts"}),(0,s.jsx)(n(),{href:"/workouts",children:(0,s.jsx)(S.Button,{variant:"outline",size:"sm",children:"View All"})})]})}),(0,s.jsxs)(k.Wu,{className:"py-8 text-center",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"No recent workouts found."}),(0,s.jsx)(n(),{href:"/templates",children:(0,s.jsx)(S.Button,{className:"mt-4",variant:"outline",children:"Start Your First Workout"})})]})]})})}}}]);