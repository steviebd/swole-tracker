(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{695:(e,t,s)=>{"use strict";s.d(t,{WorkoutStarter:()=>g});var r=s(95155),a=s(12115),i=s(52619),n=s.n(i),o=s(20063),l=s(80842),d=s(60080),c=s(3998),m=s(86948),u=s(65142),h=s(76444),x=s(20243);function g(e){let{initialTemplateId:t}=e,[s,i]=(0,a.useState)(null!=t?t:null),[g,p]=(0,a.useState)(!1),[w,S]=(0,a.useState)(new Set),[v,f]=(0,a.useState)(()=>{let e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(r,"T").concat(a,":").concat(i)}),b=(0,o.useRouter)(),{data:j,isLoading:k}=l.F.templates.getAll.useQuery(),N=l.F.workouts.start.useMutation(),y=async()=>{if(!s)return void alert("Please select a template");if(g)return void console.log("Already starting workout, ignoring duplicate request");if(w.has(s))return void alert("You just started this workout! Check your workout history or refresh the page.");p(!0);try{var e;let t=await N.mutateAsync({templateId:s,workoutDate:new Date(v)}),r=null==j?void 0:j.find(e=>e.id===s);d.z.workoutStarted(s.toString(),null!=(e=null==r?void 0:r.name)?e:"Unknown Template"),S(e=>new Set([...e,s])),setTimeout(()=>{S(e=>{let t=new Set(e);return t.delete(s),t})},12e4);try{b.push("/workout/session/".concat(t.sessionId))}catch(e){console.error("Navigation failed:",e)}}catch(e){console.error("Error creating workout session:",e),d.z.error(e,{context:"workout_start",templateId:s.toString()}),(e instanceof Error?e.message:"Unknown error").includes("Recent session found")?alert("You already have a recent workout with this template. Check your workout history!"):alert("Error starting workout. Please try again.")}finally{p(!1)}};return k?(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(m.Zp,{children:(0,r.jsxs)(m.Wu,{className:"p-4",children:[(0,r.jsx)(x.EA,{className:"mb-4 h-4 w-1/3"}),(0,r.jsx)(x.EA,{className:"h-10 w-full"})]})})}):(null==j?void 0:j.length)?(0,r.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:"Select Workout Template"}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:j.map(e=>(0,r.jsx)(m.Zp,{className:"cursor-pointer transition-all hover:shadow-md ".concat(s===e.id?"ring-primary shadow-md ring-2":"hover:ring-muted-foreground/20 hover:ring-1"),onClick:()=>i(e.id),children:(0,r.jsxs)(m.Wu,{className:"p-4",children:[(0,r.jsx)("h3",{className:"mb-2 truncate text-sm font-semibold sm:text-base",children:e.name}),(0,r.jsxs)("p",{className:"text-muted-foreground text-xs sm:text-sm",children:[e.exercises.length," exercise",1!==e.exercises.length?"s":""]}),e.exercises.length>0&&(0,r.jsxs)("div",{className:"text-muted-foreground mt-2 text-xs",children:[e.exercises.slice(0,3).map(e=>e.exerciseName).join(", "),e.exercises.length>3&&"..."]})]})},e.id))})]}),s&&(0,r.jsxs)(m.Zp,{children:[(0,r.jsx)(m.aR,{children:(0,r.jsxs)(m.ZB,{className:"text-base sm:text-lg",children:["Selected:"," ",(()=>{let e=j.find(e=>e.id===s);return null==e?void 0:e.name})()]})}),(0,r.jsx)(m.Wu,{className:"space-y-4",children:(()=>{let e=j.find(e=>e.id===s);return e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"text-muted-foreground text-xs sm:text-sm",children:0===e.exercises.length?"No exercises in this template":(0,r.jsx)("div",{className:"space-y-1",children:e.exercises.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"bg-primary text-primary-foreground mr-2 flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-full text-xs font-semibold sm:h-6 sm:w-6",children:t+1}),(0,r.jsx)("span",{className:"text-xs sm:text-sm",children:e.exerciseName})]},e.id))})})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(h.J,{htmlFor:"workoutDate",className:"text-xs font-medium sm:text-sm",children:"Workout Date & Time"}),(0,r.jsx)(c.Button,{type:"button",variant:"link",size:"sm",className:"h-auto p-0 text-xs",onClick:()=>{let e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");f("".concat(t,"-").concat(s,"-").concat(r,"T").concat(a,":").concat(i))},children:"Use Now"})]}),(0,r.jsx)(u.p,{type:"datetime-local",id:"workoutDate",value:v,onChange:e=>f(e.target.value),className:"w-full",required:!0})]}),(0,r.jsx)(c.Button,{onClick:y,disabled:g||N.isPending,className:"w-full",size:"lg",children:g||N.isPending?"Starting...":"Start Workout"})]}):null})()})]}),!s&&(0,r.jsx)("div",{className:"py-6 text-center sm:py-8",children:(0,r.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:"Select a workout template above to continue"})})]}):(0,r.jsxs)("div",{className:"py-8 text-center sm:py-12",children:[(0,r.jsx)("div",{className:"mb-4 text-4xl sm:text-6xl",children:"\uD83D\uDCCB"}),(0,r.jsx)("h3",{className:"mb-2 text-lg font-semibold sm:text-xl",children:"No templates available"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-6 px-4 text-sm sm:text-base",children:"You need to create a workout template before you can start a workout"}),(0,r.jsx)(c.Button,{asChild:!0,children:(0,r.jsx)(n(),{href:"/templates/new",children:"Create Your First Template"})})]})}},17269:(e,t,s)=>{Promise.resolve().then(s.bind(s,87958)),Promise.resolve().then(s.bind(s,33742)),Promise.resolve().then(s.bind(s,99776)),Promise.resolve().then(s.bind(s,47785)),Promise.resolve().then(s.bind(s,25979)),Promise.resolve().then(s.bind(s,59441)),Promise.resolve().then(s.bind(s,80549)),Promise.resolve().then(s.bind(s,1043)),Promise.resolve().then(s.bind(s,11515)),Promise.resolve().then(s.bind(s,53455)),Promise.resolve().then(s.bind(s,45339)),Promise.resolve().then(s.bind(s,5947)),Promise.resolve().then(s.bind(s,86639)),Promise.resolve().then(s.t.bind(s,52619,23)),Promise.resolve().then(s.bind(s,695)),Promise.resolve().then(s.bind(s,3998)),Promise.resolve().then(s.bind(s,71586))},60080:(e,t,s)=>{"use strict";s.d(t,{z:()=>i});var r=s(26614);let a=(e,t)=>{try{if("undefined"==typeof navigator||!0!==navigator.onLine)return;r.Ay.capture(e,null!=t?t:{})}catch(e){}},i={pageView:(e,t)=>{try{let s=window.location.href;a("$pageview",{$current_url:s,page:e,...t})}catch(e){}},workoutStarted:(e,t)=>{a("workout_started",{templateId:e,templateName:t,timestamp:new Date().toISOString()})},workoutCompleted:(e,t,s)=>{a("workout_completed",{sessionId:e,duration:t,exerciseCount:s,timestamp:new Date().toISOString()})},exerciseLogged:(e,t,s,r)=>{a("exercise_logged",{exerciseId:e,exerciseName:t,sets:s,weight:r,timestamp:new Date().toISOString()})},templateCreated:(e,t)=>{a("template_created",{templateId:e,exerciseCount:t,timestamp:new Date().toISOString()})},templateDeleted:e=>{a("template_deleted",{templateId:e,timestamp:new Date().toISOString()})},templateEdited:(e,t)=>{a("template_edited",{templateId:e,exerciseCount:t,timestamp:new Date().toISOString()})},templateDuplicated:e=>{a("template_duplicated",{templateId:e,timestamp:new Date().toISOString()})},weightUnitChanged:e=>{a("weight_unit_changed",{unit:e,timestamp:new Date().toISOString()})},error:(e,t)=>{a("error",{error:e.message,stack:e.stack,context:t,timestamp:new Date().toISOString()})},featureUsed:(e,t)=>{a("feature_used",{feature:e,...t,timestamp:new Date().toISOString()})},aiDebriefViewed:(e,t,s)=>{a("ai_debrief.viewed",{sessionId:e,version:t,streakLength:s,timestamp:new Date().toISOString()})},aiDebriefRegenerated:(e,t,s)=>{a("ai_debrief.regenerated",{sessionId:e,version:t,reason:s,timestamp:new Date().toISOString()})},aiDebriefDismissed:(e,t,s)=>{a("ai_debrief.dismissed",{sessionId:e,version:t,pinned:s,timestamp:new Date().toISOString()})}}},71586:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var r=s(95155),a=s(12115),i=s(31461),n=s(99776),o=s(87958);function l(e){let{children:t,state:s}=e,[l]=(0,a.useState)(()=>new i.E({defaultOptions:{queries:{staleTime:6e4,gcTime:3e5,retry:1}}}));return(0,r.jsx)(n.QueryClientProvider,{client:l,children:(0,r.jsx)(o.HydrationBoundary,{state:s,children:t})})}}},e=>{e.O(0,[8229,274,8096,126,842,8441,7358],()=>e(e.s=17269)),_N_E=e.O()}]);